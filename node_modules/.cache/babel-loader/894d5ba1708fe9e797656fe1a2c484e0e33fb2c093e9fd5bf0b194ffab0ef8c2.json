{"ast":null,"code":"import { __assign, __extends, __read, __rest, __spreadArray } from \"tslib\";\nimport { ElementEvent } from '@antv/g';\nimport { clamp, debounce } from '@antv/util';\nimport { animate, onAnimateFinished } from '../../animation';\nimport { Component } from '../../core';\nimport { Group } from '../../shapes';\nimport { BBox, classNames, hide, scaleToPixel, select, show, splitStyle, subStyleProps, transpose, visibility } from '../../util';\nimport { button } from '../marker/symbol';\nvar CLASS_NAMES = classNames({\n  prevBtnGroup: 'prev-btn-group',\n  prevBtn: 'prev-btn',\n  nextBtnGroup: 'next-btn-group',\n  nextBtn: 'next-btn',\n  pageInfoGroup: 'page-info-group',\n  pageInfo: 'page-info',\n  playWindow: 'play-window',\n  contentGroup: 'content-group',\n  controller: 'controller',\n  clipPath: 'clip-path'\n}, 'navigator');\nvar Navigator = /** @class */function (_super) {\n  __extends(Navigator, _super);\n  function Navigator(options) {\n    var _this = _super.call(this, options, {\n      animate: {\n        easing: 'linear',\n        duration: 200,\n        fill: 'both'\n      },\n      buttonCursor: 'pointer',\n      buttonFill: 'black',\n      buttonPath: button(0, 0, 6),\n      buttonSize: 12,\n      controllerPadding: 5,\n      controllerSpacing: 5,\n      formatter: function (curr, total) {\n        return \"\".concat(curr, \"/\").concat(total);\n      },\n      defaultPage: 0,\n      loop: false,\n      orientation: 'horizontal',\n      pageNumFill: 'black',\n      pageNumFontSize: 12,\n      pageNumTextAlign: 'start',\n      pageNumTextBaseline: 'middle'\n    }) || this;\n    _this.playState = 'idle';\n    _this.contentGroup = _this.appendChild(new Group({\n      class: CLASS_NAMES.contentGroup.name\n    }));\n    _this.playWindow = _this.contentGroup.appendChild(new Group({\n      class: CLASS_NAMES.playWindow.name\n    }));\n    _this.innerCurrPage = _this.defaultPage;\n    return _this;\n  }\n  Object.defineProperty(Navigator.prototype, \"defaultPage\", {\n    get: function () {\n      var defaultPage = this.attributes.defaultPage;\n      return clamp(defaultPage, 0, Math.max(this.pageViews.length - 1, 0));\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Navigator.prototype, \"pageViews\", {\n    get: function () {\n      return this.playWindow.children;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Navigator.prototype, \"controllerShape\", {\n    // todo fixme\n    get: function () {\n      return this.totalPages > 1 ? {\n        width: 55,\n        height: 0\n      } : {\n        width: 0,\n        height: 0\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Navigator.prototype, \"pageShape\", {\n    get: function () {\n      var pageViews = this.pageViews;\n      var _a = __read(transpose(pageViews.map(function (pageView) {\n          var _a = pageView.getBBox(),\n            width = _a.width,\n            height = _a.height;\n          return [width, height];\n        })).map(function (arr) {\n          return Math.max.apply(Math, __spreadArray([], __read(arr), false));\n        }), 2),\n        maxWidth = _a[0],\n        maxHeight = _a[1];\n      var _b = this.attributes,\n        _c = _b.pageWidth,\n        pageWidth = _c === void 0 ? maxWidth : _c,\n        _d = _b.pageHeight,\n        pageHeight = _d === void 0 ? maxHeight : _d;\n      return {\n        pageWidth: pageWidth,\n        pageHeight: pageHeight\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Navigator.prototype.getContainer = function () {\n    return this.playWindow;\n  };\n  Object.defineProperty(Navigator.prototype, \"totalPages\", {\n    get: function () {\n      return this.pageViews.length;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Navigator.prototype, \"currPage\", {\n    get: function () {\n      return this.innerCurrPage;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Navigator.prototype.getBBox = function () {\n    var _a = _super.prototype.getBBox.call(this),\n      x = _a.x,\n      y = _a.y;\n    var controllerShape = this.controllerShape;\n    var _b = this.pageShape,\n      pageWidth = _b.pageWidth,\n      pageHeight = _b.pageHeight;\n    return new BBox(x, y, pageWidth + controllerShape.width, pageHeight);\n  };\n  Navigator.prototype.goTo = function (pageNum) {\n    var _this = this;\n    var animateOptions = this.attributes.animate;\n    var _a = this,\n      currPage = _a.currPage,\n      playState = _a.playState,\n      playWindow = _a.playWindow,\n      pageViews = _a.pageViews;\n    if (playState !== 'idle' || pageNum < 0 || pageViews.length <= 0 || pageNum >= pageViews.length) return null;\n    pageViews[currPage].setLocalPosition(0, 0);\n    this.prepareFollowingPage(pageNum);\n    var _b = __read(this.getFollowingPageDiff(pageNum), 2),\n      dx = _b[0],\n      dy = _b[1];\n    this.playState = 'running';\n    var animation = animate(playWindow, [{\n      transform: \"translate(0, 0)\"\n    }, {\n      transform: \"translate(\".concat(-dx, \", \").concat(-dy, \")\")\n    }], animateOptions);\n    onAnimateFinished(animation, function () {\n      _this.innerCurrPage = pageNum;\n      _this.playState = 'idle';\n      _this.setVisiblePages([pageNum]);\n      _this.updatePageInfo();\n    });\n    return animation;\n  };\n  Navigator.prototype.prev = function () {\n    var loop = this.attributes.loop;\n    var pages = this.pageViews.length;\n    var page = this.currPage;\n    if (!loop && page <= 0) return null;\n    var following = loop ? (page - 1 + pages) % pages : clamp(page - 1, 0, pages);\n    return this.goTo(following);\n  };\n  Navigator.prototype.next = function () {\n    var loop = this.attributes.loop;\n    var pages = this.pageViews.length;\n    var page = this.currPage;\n    if (!loop && page >= pages - 1) return null;\n    var following = loop ? (page + 1) % pages : clamp(page + 1, 0, pages);\n    return this.goTo(following);\n  };\n  Navigator.prototype.renderClipPath = function (container) {\n    var _a = this.pageShape,\n      pageWidth = _a.pageWidth,\n      pageHeight = _a.pageHeight;\n    if (!pageWidth || !pageHeight) {\n      this.contentGroup.style.clipPath = undefined;\n      return;\n    }\n    this.clipPath = container.maybeAppendByClassName(CLASS_NAMES.clipPath, 'rect').styles({\n      width: pageWidth,\n      height: pageHeight\n    });\n    this.contentGroup.attr('clipPath', this.clipPath.node());\n  };\n  Navigator.prototype.setVisiblePages = function (pages) {\n    this.playWindow.children.forEach(function (page, index) {\n      if (pages.includes(index)) show(page);else hide(page);\n    });\n  };\n  Navigator.prototype.adjustControllerLayout = function () {\n    var _a = this,\n      prevBtn = _a.prevBtnGroup,\n      nextBtn = _a.nextBtnGroup,\n      pageNum = _a.pageInfoGroup;\n    var _b = this.attributes,\n      orientation = _b.orientation,\n      padding = _b.controllerPadding;\n    var _c = pageNum.getBBox(),\n      pW = _c.width,\n      pH = _c.height;\n    var _d = __read(orientation === 'horizontal' ? [-180, 0] : [-90, 90], 2),\n      r1 = _d[0],\n      r2 = _d[1];\n    prevBtn.setLocalEulerAngles(r1);\n    nextBtn.setLocalEulerAngles(r2);\n    var _e = prevBtn.getBBox(),\n      bpW = _e.width,\n      bpH = _e.height;\n    var _f = nextBtn.getBBox(),\n      bnW = _f.width,\n      bnH = _f.height;\n    var maxWidth = Math.max(bpW, pW, bnW);\n    var _g = orientation === 'horizontal' ? {\n        offset: [[0, 0], [bpW / 2 + padding, 0], [bpW + pW + padding * 2, 0]],\n        textAlign: 'start'\n      } : {\n        offset: [[maxWidth / 2, -bpH - padding], [maxWidth / 2, 0], [maxWidth / 2, bnH + padding]],\n        textAlign: 'center'\n      },\n      _h = __read(_g.offset, 3),\n      _j = __read(_h[0], 2),\n      o1x = _j[0],\n      o1y = _j[1],\n      _k = __read(_h[1], 2),\n      o2x = _k[0],\n      o2y = _k[1],\n      _l = __read(_h[2], 2),\n      o3x = _l[0],\n      o3y = _l[1],\n      textAlign = _g.textAlign;\n    var pageNumText = pageNum.querySelector('text');\n    pageNumText && (pageNumText.style.textAlign = textAlign);\n    prevBtn.setLocalPosition(o1x, o1y);\n    pageNum.setLocalPosition(o2x, o2y);\n    nextBtn.setLocalPosition(o3x, o3y);\n  };\n  Navigator.prototype.updatePageInfo = function () {\n    var _a;\n    var _b = this,\n      currPage = _b.currPage,\n      pageViews = _b.pageViews,\n      formatter = _b.attributes.formatter;\n    if (pageViews.length < 2) return;\n    (_a = this.pageInfoGroup.querySelector(CLASS_NAMES.pageInfo.class)) === null || _a === void 0 ? void 0 : _a.attr('text', formatter(currPage + 1, pageViews.length));\n    this.adjustControllerLayout();\n  };\n  Navigator.prototype.getFollowingPageDiff = function (pageNum) {\n    var currPage = this.currPage;\n    if (currPage === pageNum) return [0, 0];\n    var orientation = this.attributes.orientation;\n    var _a = this.pageShape,\n      pageWidth = _a.pageWidth,\n      pageHeight = _a.pageHeight;\n    var sign = pageNum < currPage ? -1 : 1;\n    return orientation === 'horizontal' ? [sign * pageWidth, 0] : [0, sign * pageHeight];\n  };\n  Navigator.prototype.prepareFollowingPage = function (pageNum) {\n    var _a = this,\n      currPage = _a.currPage,\n      pageViews = _a.pageViews;\n    this.setVisiblePages([pageNum, currPage]);\n    if (pageNum !== currPage) {\n      var _b = __read(this.getFollowingPageDiff(pageNum), 2),\n        dx = _b[0],\n        dy = _b[1];\n      pageViews[pageNum].setLocalPosition(dx, dy);\n    }\n  };\n  Navigator.prototype.renderController = function (container) {\n    var _this = this;\n    var spacing = this.attributes.controllerSpacing;\n    var _a = this.pageShape,\n      pageWidth = _a.pageWidth,\n      pageHeight = _a.pageHeight;\n    var visible = this.pageViews.length >= 2;\n    var group = container.maybeAppendByClassName(CLASS_NAMES.controller, 'g');\n    visibility(group.node(), visible);\n    if (!visible) return;\n    var style = subStyleProps(this.attributes, 'button');\n    var textStyle = subStyleProps(this.attributes, 'pageNum');\n    var _b = __read(splitStyle(style), 2),\n      _c = _b[0],\n      groupStyle = _b[1],\n      size = _c.size,\n      pathStyle = __rest(_c, [\"size\"]);\n    var whetherToAddEventListener = !group.select(CLASS_NAMES.prevBtnGroup.class).node();\n    var prevBtnGroup = group.maybeAppendByClassName(CLASS_NAMES.prevBtnGroup, 'g').styles(groupStyle);\n    this.prevBtnGroup = prevBtnGroup.node();\n    var prevBtn = prevBtnGroup.maybeAppendByClassName(CLASS_NAMES.prevBtn, 'path');\n    var nextBtnGroup = group.maybeAppendByClassName(CLASS_NAMES.nextBtnGroup, 'g').styles(groupStyle);\n    this.nextBtnGroup = nextBtnGroup.node();\n    var nextBtn = nextBtnGroup.maybeAppendByClassName(CLASS_NAMES.nextBtn, 'path');\n    [prevBtn, nextBtn].forEach(function (btn) {\n      btn.styles(__assign(__assign({}, pathStyle), {\n        transformOrigin: 'center'\n      }));\n      scaleToPixel(btn.node(), size, true);\n    });\n    var pageInfoGroup = group.maybeAppendByClassName(CLASS_NAMES.pageInfoGroup, 'g');\n    this.pageInfoGroup = pageInfoGroup.node();\n    pageInfoGroup.maybeAppendByClassName(CLASS_NAMES.pageInfo, 'text').styles(textStyle);\n    this.updatePageInfo();\n    // put it on the right side of the container\n    group.node().setLocalPosition(pageWidth + spacing, pageHeight / 2);\n    if (whetherToAddEventListener) {\n      this.prevBtnGroup.addEventListener('click', function () {\n        _this.prev();\n      });\n      this.nextBtnGroup.addEventListener('click', function () {\n        _this.next();\n      });\n    }\n  };\n  Navigator.prototype.render = function (attributes, container) {\n    /**\n     * container\n     *  |- contentGroup (with clip path)\n     *    |- playWindow (with animation)\n     *      |- pages\n     *  |- clipPath\n     */\n    var containerSelection = select(container);\n    this.renderClipPath(containerSelection);\n    this.renderController(containerSelection);\n    this.setVisiblePages([this.defaultPage]);\n    this.goTo(this.defaultPage);\n  };\n  Navigator.prototype.bindEvents = function () {\n    var _this = this;\n    var render = debounce(function () {\n      return _this.render(_this.attributes, _this);\n    }, 50);\n    this.playWindow.addEventListener(ElementEvent.INSERTED, render);\n    this.playWindow.addEventListener(ElementEvent.REMOVED, render);\n  };\n  return Navigator;\n}(Component);\nexport { Navigator };","map":{"version":3,"names":["ElementEvent","clamp","debounce","animate","onAnimateFinished","Component","Group","BBox","classNames","hide","scaleToPixel","select","show","splitStyle","subStyleProps","transpose","visibility","button","CLASS_NAMES","prevBtnGroup","prevBtn","nextBtnGroup","nextBtn","pageInfoGroup","pageInfo","playWindow","contentGroup","controller","clipPath","Navigator","_super","__extends","options","_this","call","easing","duration","fill","buttonCursor","buttonFill","buttonPath","buttonSize","controllerPadding","controllerSpacing","formatter","curr","total","concat","defaultPage","loop","orientation","pageNumFill","pageNumFontSize","pageNumTextAlign","pageNumTextBaseline","playState","appendChild","class","name","innerCurrPage","Object","defineProperty","prototype","get","attributes","Math","max","pageViews","length","children","totalPages","width","height","_a","__read","map","pageView","getBBox","arr","apply","__spreadArray","maxWidth","maxHeight","_b","_c","pageWidth","_d","pageHeight","getContainer","x","y","controllerShape","pageShape","goTo","pageNum","animateOptions","currPage","setLocalPosition","prepareFollowingPage","getFollowingPageDiff","dx","dy","animation","transform","setVisiblePages","updatePageInfo","prev","pages","page","following","next","renderClipPath","container","style","undefined","maybeAppendByClassName","styles","attr","node","forEach","index","includes","adjustControllerLayout","padding","pW","pH","r1","r2","setLocalEulerAngles","_e","bpW","bpH","_f","bnW","bnH","_g","offset","textAlign","_h","_j","o1x","o1y","_k","o2x","o2y","_l","o3x","o3y","pageNumText","querySelector","sign","renderController","spacing","visible","group","textStyle","groupStyle","size","pathStyle","__rest","whetherToAddEventListener","btn","__assign","transformOrigin","addEventListener","render","containerSelection","bindEvents","INSERTED","REMOVED"],"sources":["ui/navigator/index.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}