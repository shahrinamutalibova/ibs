{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { Path } from '@antv/g';\nimport { Marker } from '@antv/component';\nimport { line as d3line } from 'd3-shape';\nimport { isTranspose } from '../../utils/coordinate';\nimport { subObject } from '../../utils/helper';\nimport { select } from '../../utils/selection';\nimport { applyStyle } from '../utils';\nfunction inferSymbol(x, y, r) {\n  return [['M', x, y], ['L', x + 2 * r, y - r], ['L', x + 2 * r, y + r], ['Z']];\n}\n/**\n * @todo support polar later.\n */\nfunction inferConnectorPath(points) {\n  return d3line().x(d => d[0]).y(d => d[1])(points);\n}\nfunction getPoints(coordinate, points, offset1, offset2, length1 = 0) {\n  const [[x0, y0], [x1, y1]] = points;\n  if (isTranspose(coordinate)) {\n    const X0 = x0 + offset1;\n    const X1 = x1 + offset2;\n    const X = X0 + length1;\n    return [[X0, y0], [X, y0], [X, y1], [X1, y1]];\n  }\n  const Y0 = y0 - offset1;\n  const Y1 = y1 - offset2;\n  const Y = Y0 - length1;\n  return [[x0, Y0], [x0, Y], [x1, Y], [x1, Y1]];\n}\nexport const Connector = (options, context) => {\n  const {\n      offset = 0,\n      offset1 = offset,\n      offset2 = offset,\n      connectLength1: length1,\n      endMarker = true\n    } = options,\n    style = __rest(options, [\"offset\", \"offset1\", \"offset2\", \"connectLength1\", \"endMarker\"]);\n  const {\n    coordinate\n  } = context;\n  return (points, value, defaults) => {\n    const {\n        color: defaultColor,\n        connectLength1\n      } = defaults,\n      rest = __rest(defaults, [\"color\", \"connectLength1\"]);\n    const {\n      color,\n      transform\n    } = value;\n    const P = getPoints(coordinate, points, offset1, offset2, length1 !== null && length1 !== void 0 ? length1 : connectLength1);\n    const makerStyle = subObject(Object.assign(Object.assign({}, style), defaults), 'endMarker');\n    return select(new Path()).call(applyStyle, rest).style('path', inferConnectorPath(P)).style('stroke', color || defaultColor).style('transform', transform).style('markerEnd', endMarker ? new Marker({\n      className: 'marker',\n      style: Object.assign(Object.assign({}, makerStyle), {\n        symbol: inferSymbol\n      })\n    }) : null).call(applyStyle, style).node();\n  };\n};\nConnector.props = {\n  defaultMarker: 'line',\n  defaultEnterAnimation: 'fadeIn',\n  defaultUpdateAnimation: 'morphing',\n  defaultExitAnimation: 'fadeOut'\n};","map":{"version":3,"names":["Path","Marker","line","d3line","isTranspose","subObject","select","applyStyle","inferSymbol","x","y","r","inferConnectorPath","points","d","getPoints","coordinate","offset1","offset2","length1","x0","y0","x1","y1","X0","X1","X","Y0","Y1","Y","Connector","options","context","offset","connectLength1","endMarker","style","__rest","value","defaults","color","defaultColor","rest","transform","P","makerStyle","Object","assign","call","className","symbol","node","props","defaultMarker","defaultEnterAnimation","defaultUpdateAnimation","defaultExitAnimation"],"sources":["shape/connector/connector.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}