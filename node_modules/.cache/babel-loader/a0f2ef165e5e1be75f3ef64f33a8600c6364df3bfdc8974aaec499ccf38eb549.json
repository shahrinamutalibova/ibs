{"ast":null,"code":"import { HeatmapShape } from '../shape';\nimport { MaybeZeroX, MaybeZeroY } from '../transform';\nimport { baseGeometryChannels, basePostInference, basePreInference, tooltip2d } from './utils';\nconst shape = {\n  heatmap: HeatmapShape\n};\n/**\n * Draw heatmap with gradient.\n */\nexport const Heatmap = options => {\n  return (index, scale, value, coordinate) => {\n    const {\n      x: X,\n      y: Y,\n      size: S,\n      color: C\n    } = value;\n    const P = Array.from(index, i => {\n      // Default size = 40.\n      const r = S ? +S[i] : 40;\n      // Warning: x, y, value, radius.\n      return [...coordinate.map([+X[i], +Y[i]]), C[i], r];\n    });\n    return [[0], [P]];\n  };\n};\nHeatmap.props = {\n  defaultShape: 'heatmap',\n  defaultLabelShape: 'label',\n  composite: false,\n  shape,\n  channels: [...baseGeometryChannels({\n    shapes: Object.keys(shape)\n  }), {\n    name: 'x',\n    required: true\n  }, {\n    name: 'y',\n    required: true\n  }, {\n    name: 'color',\n    scale: 'identity',\n    required: true\n  }, {\n    name: 'size'\n  }],\n  preInference: [...basePreInference(), {\n    type: MaybeZeroX\n  }, {\n    type: MaybeZeroY\n  }],\n  postInference: [...basePostInference(), ...tooltip2d()]\n};","map":{"version":3,"names":["HeatmapShape","MaybeZeroX","MaybeZeroY","baseGeometryChannels","basePostInference","basePreInference","tooltip2d","shape","heatmap","Heatmap","options","index","scale","value","coordinate","x","X","y","Y","size","S","color","C","P","Array","from","i","r","map","props","defaultShape","defaultLabelShape","composite","channels","shapes","Object","keys","name","required","preInference","type","postInference"],"sources":["mark/heatmap.ts"],"sourcesContent":[null],"mappings":"AAEA,SAASA,YAAY,QAAQ,UAAU;AACvC,SAASC,UAAU,EAAEC,UAAU,QAAQ,cAAc;AACrD,SACEC,oBAAoB,EACpBC,iBAAiB,EACjBC,gBAAgB,EAChBC,SAAS,QACJ,SAAS;AAEhB,MAAMC,KAAK,GAAG;EACZC,OAAO,EAAER;CACV;AAID;;;AAGA,OAAO,MAAMS,OAAO,GAAwBC,OAAO,IAAI;EACrD,OAAO,CAACC,KAAK,EAAEC,KAAK,EAAEC,KAAK,EAAEC,UAAU,KAAI;IACzC,MAAM;MAAEC,CAAC,EAAEC,CAAC;MAAEC,CAAC,EAAEC,CAAC;MAAEC,IAAI,EAAEC,CAAC;MAAEC,KAAK,EAAEC;IAAC,CAAE,GAAGT,KAAK;IAC/C,MAAMU,CAAC,GAAGC,KAAK,CAACC,IAAI,CAACd,KAAK,EAAGe,CAAC,IAAI;MAChC;MACA,MAAMC,CAAC,GAAGP,CAAC,GAAG,CAACA,CAAC,CAACM,CAAC,CAAC,GAAG,EAAE;MACxB;MACA,OAAO,CAAC,GAAGZ,UAAU,CAACc,GAAG,CAAC,CAAC,CAACZ,CAAC,CAACU,CAAC,CAAC,EAAE,CAACR,CAAC,CAACQ,CAAC,CAAC,CAAC,CAAC,EAAEJ,CAAC,CAACI,CAAC,CAAC,EAAEC,CAAC,CAAuB;IAC3E,CAAC,CAAC;IAEF,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAACJ,CAAC,CAAC,CAAC;EACnB,CAAC;AACH,CAAC;AAEDd,OAAO,CAACoB,KAAK,GAAG;EACdC,YAAY,EAAE,SAAS;EACvBC,iBAAiB,EAAE,OAAO;EAC1BC,SAAS,EAAE,KAAK;EAChBzB,KAAK;EACL0B,QAAQ,EAAE,CACR,GAAG9B,oBAAoB,CAAC;IAAE+B,MAAM,EAAEC,MAAM,CAACC,IAAI,CAAC7B,KAAK;EAAC,CAAE,CAAC,EACvD;IAAE8B,IAAI,EAAE,GAAG;IAAEC,QAAQ,EAAE;EAAI,CAAE,EAC7B;IAAED,IAAI,EAAE,GAAG;IAAEC,QAAQ,EAAE;EAAI,CAAE,EAC7B;IAAED,IAAI,EAAE,OAAO;IAAEzB,KAAK,EAAE,UAAU;IAAE0B,QAAQ,EAAE;EAAI,CAAE,EACpD;IAAED,IAAI,EAAE;EAAM,CAAE,CACjB;EACDE,YAAY,EAAE,CACZ,GAAGlC,gBAAgB,EAAE,EACrB;IAAEmC,IAAI,EAAEvC;EAAU,CAAE,EACpB;IAAEuC,IAAI,EAAEtC;EAAU,CAAE,CACrB;EACDuC,aAAa,EAAE,CAAC,GAAGrC,iBAAiB,EAAE,EAAE,GAAGE,SAAS,EAAE;CACvD"},"metadata":{},"sourceType":"module","externalDependencies":[]}