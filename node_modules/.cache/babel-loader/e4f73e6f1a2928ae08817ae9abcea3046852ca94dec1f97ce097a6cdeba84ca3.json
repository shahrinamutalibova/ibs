{"ast":null,"code":"import { getArcObject } from '../../../shape/utils';\nimport { isCircular, isRadial } from '../../../utils/coordinate';\nimport { maybePercentage } from '../../../utils/helper';\nimport { mid } from '../../../utils/vector';\nexport function inferNonCircularStyle(position, points, value, coordinate) {\n  const {\n    bounds\n  } = value;\n  const [[x0, y0], [x1, y1]] = bounds;\n  const w = x1 - x0;\n  const h = y1 - y0;\n  const xy = options => {\n    const {\n      x: ox,\n      y: oy\n    } = options;\n    const px = maybePercentage(value.x, w);\n    const py = maybePercentage(value.y, h);\n    return Object.assign(Object.assign({}, options), {\n      x: (px || ox) + x0,\n      y: (py || oy) + y0\n    });\n  };\n  // 4 direction.\n  if (position === 'left') return xy({\n    x: 0,\n    y: h / 2,\n    textAnchor: 'start',\n    textBaseline: 'middle'\n  });\n  if (position === 'right') return xy({\n    x: w,\n    y: h / 2,\n    textAnchor: 'end',\n    textBaseline: 'middle'\n  });\n  if (position === 'top') return xy({\n    x: w / 2,\n    y: 0,\n    textAnchor: 'center',\n    textBaseline: 'top'\n  });\n  if (position === 'bottom') return xy({\n    x: w / 2,\n    y: h,\n    textAnchor: 'center',\n    textBaseline: 'bottom'\n  });\n  // 4 corner position.\n  if (position === 'top-left') return xy({\n    x: 0,\n    y: 0,\n    textAnchor: 'start',\n    textBaseline: 'top'\n  });\n  if (position === 'top-right') return xy({\n    x: w,\n    y: 0,\n    textAnchor: 'end',\n    textBaseline: 'top'\n  });\n  if (position === 'bottom-left') return xy({\n    x: 0,\n    y: h,\n    textAnchor: 'start',\n    textBaseline: 'bottom'\n  });\n  if (position === 'bottom-right') return xy({\n    x: w,\n    y: h,\n    textAnchor: 'end',\n    textBaseline: 'bottom'\n  });\n  // default return 'inside'\n  return xy({\n    x: w / 2,\n    y: h / 2,\n    textAnchor: 'center',\n    textBaseline: 'middle'\n  });\n}\nexport function inferRadialStyle(position, points, value, coordinate) {\n  const {\n    y,\n    y1,\n    autoRotate,\n    rotateToAlignArc\n  } = value;\n  const center = coordinate.getCenter();\n  const arcObject = getArcObject(coordinate, points, [y, y1]);\n  const {\n    innerRadius,\n    outerRadius,\n    startAngle,\n    endAngle\n  } = arcObject;\n  const angle = position === 'inside' ? (startAngle + endAngle) / 2 : endAngle;\n  const rotate = inferRotation(angle, autoRotate, rotateToAlignArc);\n  const point = (() => {\n    const [p0, p1] = points;\n    const radius = innerRadius + (outerRadius - innerRadius) * 0.5;\n    const [x, y] = position === 'inside' ? pointOfArc(center, angle, radius) : mid(p0, p1);\n    return {\n      x,\n      y\n    };\n  })();\n  return Object.assign(Object.assign({}, point), {\n    textAlign: position === 'inside' ? 'center' : 'start',\n    textBaseline: 'middle',\n    rotate\n  });\n}\nexport function pointOfArc(center, angle, radius) {\n  return [center[0] + Math.sin(angle) * radius, center[1] - Math.cos(angle) * radius];\n}\nexport function inferRotation(angle, autoRotate, rotateToAlignArc) {\n  if (!autoRotate) return 0;\n  const append = rotateToAlignArc ? 0 : Math.sin(angle) < 0 ? 90 : -90;\n  return angle / Math.PI * 180 + append;\n}\nfunction inferInnerCircularStyle(position, points, value, coordinate) {\n  const {\n    y,\n    y1,\n    autoRotate,\n    rotateToAlignArc,\n    radius: radiusRatio = 0.5,\n    offset = 0\n  } = value;\n  const arcObject = getArcObject(coordinate, points, [y, y1]);\n  const {\n    startAngle,\n    endAngle\n  } = arcObject;\n  const center = coordinate.getCenter();\n  const angle = (startAngle + endAngle) / 2;\n  const rotate = inferRotation(angle, autoRotate, rotateToAlignArc);\n  const textStyle = {\n    textAlign: 'center',\n    textBaseline: 'middle',\n    rotate\n  };\n  const {\n    innerRadius,\n    outerRadius\n  } = arcObject;\n  const r0 = innerRadius + (outerRadius - innerRadius) * radiusRatio;\n  const r1 = r0 + offset;\n  const [x0, y0] = pointOfArc(center, angle, r1);\n  return Object.assign({\n    x: x0,\n    y: y0\n  }, textStyle);\n}\n// Set to null will not be set with default value as below.\n// const { x = 0 } = options;\nfunction maybeUndefined(d) {\n  return d === undefined ? null : d;\n}\nexport function inferIdentityStyle(position, points, value, coordinate) {\n  const {\n    bounds\n  } = value;\n  const [p] = bounds;\n  return {\n    x: maybeUndefined(p[0]),\n    y: maybeUndefined(p[1])\n  };\n}\nexport function getDefaultStyle(position, points, value, coordinate) {\n  const {\n    bounds\n  } = value;\n  // When bounds.length = 1\n  // For series mark, such as line and area.\n  // The bounds for text is defined with only one point.\n  // Use this point as the label position.\n  if (bounds.length === 1) {\n    return inferIdentityStyle(position, points, value, coordinate);\n  }\n  const inferDefaultStyle = isRadial(coordinate) ? inferRadialStyle : isCircular(coordinate) ? inferInnerCircularStyle : inferNonCircularStyle;\n  return inferDefaultStyle(position, points, value, coordinate);\n}","map":{"version":3,"names":["getArcObject","isCircular","isRadial","maybePercentage","mid","inferNonCircularStyle","position","points","value","coordinate","bounds","x0","y0","x1","y1","w","h","xy","options","x","ox","y","oy","px","py","Object","assign","textAnchor","textBaseline","inferRadialStyle","autoRotate","rotateToAlignArc","center","getCenter","arcObject","innerRadius","outerRadius","startAngle","endAngle","angle","rotate","inferRotation","point","p0","p1","radius","pointOfArc","textAlign","Math","sin","cos","append","PI","inferInnerCircularStyle","radiusRatio","offset","textStyle","r0","r1","maybeUndefined","d","undefined","inferIdentityStyle","p","getDefaultStyle","length","inferDefaultStyle"],"sources":["shape/label/position/default.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}