{"ast":null,"code":"import { __read } from \"tslib\";\nimport { degToRad, parseSeriesAttr, textOf } from '../../../util';\nvar Bounds = /** @class */function () {\n  function Bounds(x1, y1, x2, y2) {\n    this.set(x1, y1, x2, y2);\n  }\n  Object.defineProperty(Bounds.prototype, \"left\", {\n    get: function () {\n      return this.x1;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Bounds.prototype, \"top\", {\n    get: function () {\n      return this.y1;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Bounds.prototype, \"right\", {\n    get: function () {\n      return this.x2;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Bounds.prototype, \"bottom\", {\n    get: function () {\n      return this.y2;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Bounds.prototype, \"width\", {\n    get: function () {\n      return this.defined('x2') && this.defined('x1') ? this.x2 - this.x1 : undefined;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Bounds.prototype, \"height\", {\n    get: function () {\n      return this.defined('y2') && this.defined('y1') ? this.y2 - this.y1 : undefined;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Bounds.prototype.rotatedPoints = function (radian, x, y) {\n    var _a = this,\n      x1 = _a.x1,\n      y1 = _a.y1,\n      x2 = _a.x2,\n      y2 = _a.y2;\n    var cos = Math.cos(radian);\n    var sin = Math.sin(radian);\n    var cx = x - x * cos + y * sin;\n    var cy = y - x * sin - y * cos;\n    var points = [[cos * x1 - sin * y2 + cx, sin * x1 + cos * y2 + cy], [cos * x2 - sin * y2 + cx, sin * x2 + cos * y2 + cy], [cos * x1 - sin * y1 + cx, sin * x1 + cos * y1 + cy], [cos * x2 - sin * y1 + cx, sin * x2 + cos * y1 + cy]];\n    return points;\n  };\n  Bounds.prototype.set = function (x1, y1, x2, y2) {\n    if (x2 < x1) {\n      this.x2 = x1;\n      this.x1 = x2;\n    } else {\n      this.x1 = x1;\n      this.x2 = x2;\n    }\n    if (y2 < y1) {\n      this.y2 = y1;\n      this.y1 = y2;\n    } else {\n      this.y1 = y1;\n      this.y2 = y2;\n    }\n    return this;\n  };\n  Bounds.prototype.defined = function (key) {\n    return this[key] !== Number.MAX_VALUE && this[key] !== -Number.MAX_VALUE;\n  };\n  return Bounds;\n}();\nexport { Bounds };\nexport function getBounds(item, margin) {\n  var angle = item.getEulerAngles() || 0;\n  item.setEulerAngles(0);\n  // get dimensions\n  var _a = item.getLocalBounds(),\n    _b = __read(_a.min, 2),\n    x = _b[0],\n    y = _b[1],\n    _c = __read(_a.max, 2),\n    right = _c[0],\n    bottom = _c[1];\n  var _d = getBBox(item),\n    w = _d.width,\n    h = _d.height;\n  var height = h;\n  var dx = 0;\n  var dy = 0;\n  var anchorX = x;\n  var anchorY = y;\n  var text = textOf(item);\n  if (text) {\n    // [to fix] 目前 G 上计算 bbox 有一点误差\n    height -= 1.5;\n    var a = text.style.textAlign;\n    var b_1 = text.style.textBaseline;\n    // horizontal alignment\n    if (a === 'center') {\n      anchorX = (x + right) / 2;\n    } else if (a === 'right' || a === 'end') {\n      anchorX = right;\n    } else {\n      // left by default, do nothing\n    }\n    // vertical alignment\n    if (b_1 === 'middle') {\n      anchorY = (y + bottom) / 2;\n    } else if (b_1 === 'bottom') {\n      anchorY = bottom;\n    }\n  }\n  var _e = __read(parseSeriesAttr(margin), 4),\n    _f = _e[0],\n    t = _f === void 0 ? 0 : _f,\n    _g = _e[1],\n    r = _g === void 0 ? 0 : _g,\n    _h = _e[2],\n    b = _h === void 0 ? t : _h,\n    _j = _e[3],\n    l = _j === void 0 ? r : _j;\n  var bounds = new Bounds((dx += x) - l, (dy += y) - t, dx + w + r, dy + height + b);\n  item.setEulerAngles(angle);\n  return bounds.rotatedPoints(degToRad(angle), anchorX, anchorY);\n}\nexport function getBBox(shape) {\n  // @ts-ignore\n  if (shape.__bbox__) return shape.__bbox__;\n  return shape.getBBox();\n}","map":{"version":3,"names":["degToRad","parseSeriesAttr","textOf","Bounds","x1","y1","x2","y2","set","Object","defineProperty","prototype","get","defined","undefined","rotatedPoints","radian","x","y","_a","cos","Math","sin","cx","cy","points","key","Number","MAX_VALUE","getBounds","item","margin","angle","getEulerAngles","setEulerAngles","getLocalBounds","_b","__read","min","_c","max","right","bottom","_d","getBBox","w","width","h","height","dx","dy","anchorX","anchorY","text","a","style","textAlign","b_1","textBaseline","_e","_f","t","_g","r","_h","b","_j","l","bounds","shape","__bbox__"],"sources":["ui/axis/utils/bounds.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}