{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { select } from '../../utils/selection';\nimport { applyStyle } from '../../shape/utils';\nimport { isTranspose, isCircular } from '../../utils/coordinate';\nimport { camelCase } from '../../utils/string';\nimport { Advance } from '../text/advance';\nimport * as PositionProcessor from './position';\nfunction inferPosition(position, coordinate) {\n  if (position !== undefined) return position;\n  if (isCircular(coordinate)) return 'inside';\n  if (isTranspose(coordinate)) return 'right';\n  return 'top';\n}\nfunction getDefaultStyle(points, value, coordinate, theme, options) {\n  // For non-series mark, calc position for label based on\n  // position and the bounds of shape.\n  const {\n    position\n  } = value;\n  const {\n    render\n  } = options;\n  const p = inferPosition(position, coordinate);\n  const labelType = render ? 'htmlLabel' : p === 'inside' ? 'innerLabel' : 'label';\n  const t = theme[labelType];\n  const v = Object.assign({}, t, value);\n  const processor = PositionProcessor[camelCase(p)];\n  if (!processor) {\n    throw new Error(`Unknown position: ${p}`);\n  }\n  return Object.assign(Object.assign({}, t), processor(p, points, v, coordinate, options));\n}\n/**\n * Render normal label for each mark.\n * @todo Support position option: middle...\n */\nexport const Label = (options, context) => {\n  const {\n    coordinate,\n    theme\n  } = context;\n  const {\n    render\n  } = options;\n  return (points, value) => {\n    const {\n        text,\n        x,\n        y,\n        transform: specifiedTS = '',\n        transformOrigin,\n        className = ''\n      } = value,\n      overrideStyle = __rest(value, [\"text\", \"x\", \"y\", \"transform\", \"transformOrigin\", \"className\"]);\n    const _a = getDefaultStyle(points, value, coordinate, theme, options),\n      {\n        rotate = 0,\n        transform = ''\n      } = _a,\n      defaultStyle = __rest(_a, [\"rotate\", \"transform\"]);\n    return select(new Advance()).call(applyStyle, defaultStyle).style('text', `${text}`).style('className', `${className} g2-label`).style('innerHTML', render ? render(text, value.datum, value.index) : undefined).style('labelTransform', `${transform} rotate(${+rotate}) ${specifiedTS}`.trim()).style('labelTransformOrigin', transformOrigin).style('coordCenter', coordinate.getCenter()).call(applyStyle, overrideStyle).node();\n  };\n};\nLabel.props = {\n  defaultMarker: 'point'\n};","map":{"version":3,"names":["select","applyStyle","isTranspose","isCircular","camelCase","Advance","PositionProcessor","inferPosition","position","coordinate","undefined","getDefaultStyle","points","value","theme","options","render","p","labelType","t","v","Object","assign","processor","Error","Label","context","text","x","y","transform","specifiedTS","transformOrigin","className","overrideStyle","__rest","_a","rotate","defaultStyle","call","style","datum","index","trim","getCenter","node","props","defaultMarker"],"sources":["shape/label/label.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}